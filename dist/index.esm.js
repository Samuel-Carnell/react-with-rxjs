import{useCallback as r,useRef as t,useEffect as e,useState as n,useLayoutEffect as u}from"react";import{asapScheduler as c,BehaviorSubject as o,isObservable as s}from"rxjs";function a(r,t){return Array.isArray(r)?function(r,t){return r.map(t)}(r,t):function(r,t){return Object.keys(r).map((t=>[t,r[t]])).reduce(((r,[e,n])=>(r[e]=t(n),r)),{})}(r,t)}function i(){const e=t(),u=function(){const[,t]=n(Object.create(null));return r((()=>{t(Object.create(null))}),[t])}();return[r((()=>{void 0===e.current&&(e.current=u,c.schedule((()=>{void 0!==e.current&&(e.current(),e.current=void 0)})))}),[]),r((()=>{e.current=void 0}),[])]}class f{constructor(r){this._value=r}setState(r){this._value=r}getCurrentState(){return this._value}}function l(){const n=function(){const n=t([]);return e((()=>()=>{n.current.forEach((r=>{r.closed||r.unsubscribe()}))}),[]),r((r=>{n.current.push(r)}),[])}(),[c,o]=i();return u((()=>o)),r((r=>{let t=!0;const e=new f({});return n(r.subscribe({error(r){e.setState({error:r}),t||c()},next(r){e.setState({value:r}),t||c()}})),t=!1,e}),[])}function b(r){return function(...t){const u=l(),c=function(r){const[t]=n((()=>r.map((r=>new o(r)))));return e((()=>{t.forEach(((t,e)=>{const n=r[e];Object.is(n,t.getValue())||t.next(n)}))})),t}(t),[i]=n((()=>{const t=r(...c);if(!Array.isArray(t)&&("object"!=typeof(e=t)||null===e||Object.getPrototypeOf(e).constructor!==Object))throw new Error("Function getState must return either an object or array.");var e;return a(t,(r=>s(r)?u(r):r))}));return a(i,(r=>{if(!(r instanceof f))return r;const t=r.getCurrentState();if(void 0!==t.error)throw t.error;return t.value}))}}export default b;export{b as bind};
//# sourceMappingURL=index.esm.js.map
